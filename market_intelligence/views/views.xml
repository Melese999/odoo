<odoo>
  <data>

    <record model="ir.ui.view" id="market_intelligence.list">
      <field name="name">Market intelligence list</field>
      <field name="model">market_intelligence.market_intelligence</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name"/>
          <field name="date"/>
          <field name="competitor_id"/>
          <field name="company_ids"/>
          <field name="line_ids"/>
          <field name="remark"/>
        </tree>
      </field>
    </record>

    <record id="view_market_intelligence_form" model="ir.ui.view">
      <field name="name">market_intelligence.market_intelligence.form</field>
      <field name="model">market_intelligence.market_intelligence</field>
      <field name="arch" type="xml">
        <form string="market_intelligence" chatter_position="sided">
          <sheet>

            <group>
              <group>
                <field name="name"/>
                <field name="date"/>
                <field name="competitor_id"/>
                <field name="company_ids" widget="many2many_tags" placeholder="select company's this market_intelligence belongs to"/>
                <field name="remark"/>

              </group>
              <notebook>
                <page string="Product Lines">
                  <field name="line_ids">
                    <tree editable="bottom">
                      <field name="product_id"/>
                      <field name="unit_price"/>
                      <field name="unit_price_uom_id"/>
                      <field name="stock"/>
                      <field name="stock_uom_id"/>
                    </tree>
                    <form>
                      <group>
                        <field name="product_id"/>
                        <field name="unit_price"/>
                        <field name="unit_price_uom_id"/>
                        <field name="stock"/>
                        <field name="stock_uom_id"/>
                        <field name="description"/>
                      </group>
                    </form>
                  </field>
                </page>
              </notebook>

            </group>
          </sheet>
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers"/>
            <field name="activity_ids" widget="mail_activity"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
        </form>
      </field>
    </record>


    <record id="view_market_intelligence_price_trend_graph" model="ir.ui.view">
      <field name="name">market.intelligence.price.trend.graph</field>
      <field name="model">market_intelligence.market_intelligence_line</field>
      <field name="arch" type="xml">
        <graph string="Product Price Trend" type="line" disable_linking="1">
          <field name="mi_date" type="row" interval="day"/>
          <field name="unit_price" type="measure"/>
          <field name="product_id" type="col"/>
        </graph>
      </field>
    </record>
    <record id="view_market_intelligence_line_tree" model="ir.ui.view">
      <field name="name">market.intelligence.line.tree</field>
      <field name="model">market_intelligence.market_intelligence_line</field>
      <field name="arch" type="xml">
        <tree string="Market Intelligence Lines">
          <field name="market_intelligence_id" string="MI Number"/>
          <field name="mi_date"/>
          <field name="product_id"/>
          <field name="competitor_id"/>
          <field name="unit_price"/>
          <field name="unit_price_uom_id" string=""/>
          <field name="stock"/>
          <field name="stock_uom_id" string=""/>
        </tree>
      </field>
    </record>

    <record id="view_market_intelligence_line_search" model="ir.ui.view">
      <field name="name">market.intelligence.line.search</field>
      <field name="model">market_intelligence.market_intelligence_line</field>
      <field name="arch" type="xml">
        <search string="Market Intelligence">
          <field name="product_id" string="Product"/>
          <field name="competitor_id" string="Competitor"/>

          <filter name="today" string="Today" domain="[('mi_date','=',context_today)]"/>

          <group expand="0" string="Group By">
            <filter name="group_by_date" string="Date" context="{'group_by':'mi_date'}"/>
            <filter name="group_by_product" string="Product" context="{'group_by':'product_id'}"/>
            <filter name="group_by_competitor" string="Competitor" context="{'group_by':'competitor_id'}"/>
          </group>
        </search>
      </field>
    </record>


    <record model="ir.actions.act_window" id="action_market_intelligence_line_graph">
      <field name="name">Market Intelligence Report</field>
      <field name="res_model">market_intelligence.market_intelligence_line</field>
      <field name="view_mode">tree,graph,form</field>
      <field name="view_id" ref="view_market_intelligence_price_trend_graph"/>
      <field name="search_view_id" ref="view_market_intelligence_line_search"/>
      <field name="context">{}</field>

    </record>


    <record model="ir.actions.act_window" id="market_intelligence.action_window">
      <field name="name">Market intelligence</field>
      <field name="res_model">market_intelligence.market_intelligence</field>
      <field name="view_mode">tree,form</field>
    </record>


    <menuitem name="Market Intelligence" id="market_intelligence_menu_root" parent="crm.crm_menu_root" groups="base.group_user"/>

    <menuitem name="Market Intelligence List" id="market_intelligence_menu_list" parent="market_intelligence_menu_root" action="market_intelligence.action_window" groups="base.group_user"/>

    <menuitem name="Competitors" id="competitor_menu_list" parent="market_intelligence_menu_root" action="competitor.action_window" groups="base.group_user"/>

    <menuitem id="market_intelligence_menu_settings" name="Settings" parent="market_intelligence_menu_root" groups="base.group_user"/>

    <menuitem name="Industry Types" id="market_intelligence_menu_industry" parent="market_intelligence_menu_settings" action="competitor.competitor_industries_action_window" groups="base.group_user"/>

    <menuitem name="MI Report" id="menu_market_intelligence_graph" parent="market_intelligence_menu_root" action="action_market_intelligence_line_graph"/>

  </data>
</odoo>
